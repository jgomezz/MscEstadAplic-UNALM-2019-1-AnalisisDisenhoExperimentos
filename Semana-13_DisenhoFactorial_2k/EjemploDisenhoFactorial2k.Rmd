---
title: "EjemploExperimentoFactorial"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Read dataset
```{r }
abono1<-read.table("abono1.txt",header=T)
str(abono1)
```

## Transformation Factor
```{r }
rend<-abono1$rend
bloques<-as.factor(abono1$bloques)
dosis<-as.factor(abono1$dosis)
tipo<-as.factor(abono1$abono)
```


## Define model
```{r}
mod<-lm(rend~bloques+tipo+dosis+tipo*dosis)
```


# Disenho Factorial 2k

```{r echo=FALSE}
library(DoE.base)
fac.design(nlevels=c(2,2),factor.names=list(one=c(15,25),two=c(1,2)), replications=3)
```
```{r}
y   <- c(28,25,27,36,32,32,18,19,23,31,30,29)
A   <- rep(c(rep(-1,3),rep(1,3)),2)
B   <- c(rep(-1,6),rep(1,6))
AB  <- A*B
XA  <- data.frame(y,A)
XAp <- XA[XA$A==1,]
XAn <- XA[XA$A==-1,]
XAp
```

```{r}
XAn
```

```{r}
A <- mean(XAp$y)-mean(XAn$y) 
A
```
```{r} 
XB  <- data.frame(y,B)
XBp <- XB[XB$B==1,]
XBn <- XB[XB$B==-1,]
B <- mean(XBp$y)-mean(XBn$y)
B
```
Explicaci\'on : Pasar del nivel bajo al nivel alto de B el promedio es negativo, Se interpreta que el rendimiento promedio obtenido con el nivel alto de B es inferior al rendimiento promedio obtenido con el nivel bajo de B es 5 unidades. 

Si es positivo el rendimiento promedio del nivel alto de B es mayor al rendimiento promedio del nivel bajo de B.

```{r}
XAB <- data.frame(y,AB)
XABp <- XAB[XAB$AB==1,]
XABn <- XAB[XAB$AB==-1,]
contrasteAB <- sum(XABp$y)-sum(XABn$y) 
AB <- contrasteAB/(2*3)
AB
```

## Analisis de Varianza

Si p_value < 0.001, la prueba resulta muy altamente significativa, se rechaza $H_{0}$


$y=\beta_{0} + \beta_{1}*x_{1} + \beta_{2}*x_{2}$

Continuando con el ejemplo 6.1

```{r}
y <- c(28,25,27,36,32,32,18,19,23,31,30,29)
A <- rep(c(rep(-1,3),rep(1,3)),2)
B <- c(rep(-1,6),rep(1,6))
mod <- lm(y~A+B+A*B)
```

Otra forma de encontrar los efectos estimados
```{r}
betaest <- coefficients(mod)
summary(betaest)
```
Mostrar los coeficientes de regresi\'on
```{r}
betaest
```

```{r}
efectosest <- 2*betaest[2:4]
data.frame(efectosest)
```
```{r}
anva<-aov(mod)
summary(anva)
```



Se puede concluir que ambos efectos principales: concentración de reactivo y cantidad de catalizador influyen significativamente a un nivel del 1%. En cambio, La prueba de hipótesis sobre el efecto de la interacción (concentración de reactivo y cantidad de catalizador) resultó no significativa a un nivel del 10%.