---
title: "Practica-02"
output: html_document
---

Nombre : Jaime Gomez Marin

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Pregunta 1

Los totales de porcentaje por combinaciones de tratamientos se dan a continuación Temperatura

1.- Se realiza un experimento para estudiar la influencia que tiene la temperatura de operación y tres tipos de vidrio sobre la luminosidad producida por un tubo de osciloscopio. Por cada combinación de tratamiento se hizo tres réplicas Del experimento realizado se obtuvieron los siguientes totales sobre luminosidad en lumen por combinación de tratamiento
Tipo de Vidrio|     baja    |    media    |      alta 
--------------|-------------|-------------|-------------
         1    |280, 290, 285|300, 310, 295|290, 285, 290
         2    |230, 235, 240|260, 240, 235|220, 225, 230
         3    |260, 258, 262|265, 272, 268|245, 250,240
         
a). Realice el análisis de variancia pruebe las hipótesis correspondientes. De las conclusiones y recomendaciones adecuadas para este caso. 
```{r results='hide', message=FALSE, warning=FALSE}
library(agricolae)
luminosidad <- read.table("luminosidad.txt", header = TRUE)
head(luminosidad)
```
```{r}
str(luminosidad)
```
```{r}
luminosidad$tipo_vidrio <- factor(luminosidad$tipo_vidrio)
luminosidad$temperatura <- factor(luminosidad$temperatura)
#luminosidad$repeticion <- factor(luminosidad$repeticion)

str(luminosidad)
```
```{r results='hide', message=FALSE, warning=FALSE}
mod<-lm(luminosidad~tipo_vidrio+temperatura+tipo_vidrio*temperatura ,data=luminosidad)
anva<-anova(mod)
anva
```

$H_0$ : $(\alpha * \beta )_ = 0$ , para i,j = 1,2,3

$H_1$ : al menos dos $(\alpha * \beta ) != 0$    , para i,j = 1,2,3
 
Se acepta $H_0$, no se ha encontrado suficiente evidencia estadistica para rechazar la $H_0$ de que ning\'un efecto de la interaci\'on entre el tipo de vidrio y la temperatura de operaci\'on del foco influye sobre la luminicidad producida por un tubo de osciloscopio.


 $H_0$ : $\alpha_i = 0$ , para i = 1,2,3 
 
 $H_1$ : al menos dos $\alpha_i != 0$    , para i = 1,2,3
 
Se rechaza la $H_0$, a un nivel de significacion del 0.1%, se ha encontrado suficientes evidencia estadistica para  rechazar la $H_0$ de que el tipo de vidrio tenga un efecto significativo sobre la luminicidad producida por un tubo de osciloscopio.Por lo tanto, se puede aceptar de que existe diferencias significativas entre al menos dos lumnicidad producida por un tubo de osciloscopio entre dos tipos de vidrios.

  $H_0$ : $\beta_j$ = 0 , para j = 1,2,3 
  
  $H_1$ : al menos dos $\beta_j != 0$    , para j = 1,2,3 
 
Se acepta $H_0$, a un nivel de significaci\'on del 0.1% se ha encontrado suficiente evidencia estadistica para rechazar la $H_0$ de que ning\'un de las temperatura de operaci\'on de un tubo de osciloscopio tiene un efecto significativo sobre la luminicidad producida por un tubo de osciloscopio.Por lo tanto, se puede aceptar de que existe diferencias muy altamente significativas entre al menos dos lumnicidades producida por un tubo de osciloscopio entre dos temperatura de operaci\'on de un tubo de osciloscopio.

b).- Realice el diagnóstico del modelo

```{r}
par(mfrow=c(2,2))
plot(mod)
```
Hay valores 
Grafico 1: 
Grafico 2:
Grafico 3: Fuerte decreciente (nopodria cumplirse el supuesto de variabilidad)
Grafico 4:

Prueba de Shapiro
$H_0$: La distribucion de los errores es la distribucion normal
$H_1$: La distribucion de los errores es diferente a la distribucion normal
```{r}
ri<-rstandard(mod)
shapiro.test(ri)
```
Se acepta la $H_0$, a un nivel de significancia de 10% (Se puede recomendar que se haga mas numero de repeticiones)

```{r results='hide', message=FALSE, warning=FALSE}
library(car)
ncvTest(mod)
```
### No se distribuye normalmente (altera normalidad)
### Cumple con el supuesto de homogeneidad de variancia


c) Realice el análisis de efecto simple asumiendo que se cumple con los supuestos

```{r}
anva<-anova(mod)
anva
summary(anva)
```

```{r}
CMe <- anva$"Mean Sq"
CME <- CMe[5]
CME
```

```{r}
SCe <- anva$"Sum Sq"
SCE <- SCe[4]
SCE
```

```{r}
head(luminosidad)
```

#La data se divide por tipos de vidrio (tipo_vidrio=1, tipo_vidrio=2 y tipo_vidrio=3)
```{r}
lumninosidad_x_tipo_vidrio_1 <- luminosidad[luminosidad$tipo_vidrio=="1",]
lumninosidad_x_tipo_vidrio_1
```

```{r}
lumninosidad_x_tipo_vidrio_2 <- luminosidad[luminosidad$tipo_vidrio=="2",]
lumninosidad_x_tipo_vidrio_2
```

```{r}
lumninosidad_x_tipo_vidrio_3 <- luminosidad[luminosidad$tipo_vidrio=="3",]
lumninosidad_x_tipo_vidrio_3
```
```{r}
lumninosidad_x_temp_baja <- luminosidad[luminosidad$temperatura=="baja",]
lumninosidad_x_temp_baja
```

```{r}
lumninosidad_x_temp_media <- luminosidad[luminosidad$temperatura=="media",]
lumninosidad_x_temp_media
```

```{r}
lumninosidad_x_temp_alta <- luminosidad[luminosidad$temperatura=="alta",]
lumninosidad_x_temp_alta
```
```{r}
mod_tipo_vidrio_1 <- lm(luminosidad ~ as.factor(temperatura),lumninosidad_x_tipo_vidrio_1)
mod_tipo_vidrio_2 <- lm(luminosidad ~ as.factor(temperatura),lumninosidad_x_tipo_vidrio_2)
mod_tipo_vidrio_3 <- lm(luminosidad ~ as.factor(temperatura),lumninosidad_x_tipo_vidrio_3)

anva_tipo_vidrio_1 <- anova(mod_tipo_vidrio_1)
anva_tipo_vidrio_2 <- anova(mod_tipo_vidrio_2)
anva_tipo_vidrio_3 <- anova(mod_tipo_vidrio_3)

SCM_TV1 <- anva_tipo_vidrio_1$Sum[1]
SCM_TV2 <- anva_tipo_vidrio_2$Sum[1]
SCM_TV3 <- anva_tipo_vidrio_3$Sum[1]

CMM_TV1 <- anva_tipo_vidrio_1$Mean[1]
CMM_TV2 <- anva_tipo_vidrio_2$Mean[1]
CMM_TV3 <- anva_tipo_vidrio_3$Mean[1]

```


```{r}
mod_temp_baja  <- lm(luminosidad ~ as.factor(tipo_vidrio),lumninosidad_x_temp_baja)
mod_temp_media <- lm(luminosidad ~ as.factor(tipo_vidrio),lumninosidad_x_temp_media)
mod_temp_alta  <- lm(luminosidad ~ as.factor(tipo_vidrio),lumninosidad_x_temp_alta)

anva_temp_baja  <- anova(mod_temp_baja)
anva_temp_media <- anova(mod_temp_media)
anva_temp_alta  <- anova(mod_temp_alta)

SCT_TB <- anva_temp_baja$Sum[1]
SCT_TM <- anva_temp_media$Sum[1]
SCT_TA <- anva_temp_alta$Sum[1]

CMT_TB <- anva_temp_baja$Mean[1]
CMT_TM <- anva_temp_media$Mean[1]
CMT_TA <- anva_temp_alta$Mean[1]
```

Suma de cuadrados
```{r}
SC  <- round(c(SCM_TV1,SCM_TV2,SCM_TV3,SCT_TB,SCT_TM,SCT_TA,SCE),6)
GLE <- 18  
CME <- SCE/GLE
```

Cuadrado medio
```{r}
CM  <- round(c(CMM_TV1,CMM_TV2,CMM_TV3,CMT_TB,CMT_TM,CMT_TA,CME),6)
# Grados de libertad
GL  <- c(rep(2,6), GLE)
Fc1 <- round(CM[1:6]/CM[7],6)
Fc  <- c(Fc1,"")
```

```{r}
pvalue1 <-  round(1-pf(Fc1,2,GLE),6)
pvalue  <-  c(pvalue1,"")
```

```{r}
Fuente <- c("A es b1","A es b2","A es b3","B es b1","B es b2","B es b3","residuales")
data.frame(Fuente, GL, SC, CM, Fc, pvalue)
```

d) Para una temperatura alta realice la prueba de Tukey para comparar las medias de luminosidad producidos entre los tipos de vidrios. De sus conclusiones y recomendaciones en términos de las variables en estudios.
```{r}
aov_temp_alta<-aov(mod_temp_alta)
tHSD <- TukeyHSD(aov_temp_alta)
print(tHSD)
```

e) Para una temperatura alta realice la prueba de Duncan para comparar las medias de luminosidad producidos entre los tipos de vidrios. De sus conclusiones y recomendaciones en términos de las variables en estudios.  Compare con lo obtenido en d)

```{r}
#aov_temp_alta <- aov(mod_temp_alta)
summary(aov_temp_alta)
```
```{r}
comp <- duncan.test(aov_temp_alta,"as.factor(tipo_vidrio)")
comp
```

f) Para tipo de vidrio tres, se desea comparar la media de luminosidad de b2 versus (b1 y b3)
¿Qué supuestos se deben cumplir para poder realizar esta comparación? Asumiendo que se cumple estos supuestos, utilice la prueba de T para realizar esta comparación.


$\mu_{baja}$ = media de luminosidad para una temperatura baja cuando se usa el tipo de vidrio 3.
$\mu_{media}$ = media de luminosidad para una temperatura media cuando se usa el tipo de vidrio 3.
$\mu_{alta}$ = media de luminosidad para una temperatura alta cuando se usa el tipo de vidrio 3.

Hipotesis :
-----------

$H_O$: 2$\mu_{media}$ = $\mu_{baja}$ + $\mu_{alta}$ 
$H_1$: 2$\mu_{media}$ != $\mu_{baja}$ + $\mu_{alta}$ 

Matriz de Ortogonales :
-----------------------

Coeficientes | $T_{baja}$ | $T_{media}$ | $T_{alta}$
-----------------------------------------------------
$C_{11}$     |     1      |     -2       |    1

Constrastes Ortogonales :
-------------------------
$Q_{1}$ = $Y_{baja}$ - 2$Y_{media}$ + $Y_{alta}$ 

```{r}
aov_tipo_vidrio_3 <- aov(mod_tipo_vidrio_3)
summary(aov_tipo_vidrio_3)
#summary(mod_tipo_vidrio_3)
```
```{r}
yp<-sort(tapply(lumninosidad_x_tipo_vidrio_3$luminosidad,lumninosidad_x_tipo_vidrio_3$temperatura,mean))
yp
```
```{r}
c1<-c(1,1,-2)
tc<-(t(c1)%*%yp)/sqrt((13.8/2)*sum(c1^2))
tc
```

```{r}
pvalue<-2*(1-pt(tc,6))
pvalue

```

g) Utilice la prueba de Scheffe para probar la comparación dado en f). De sus conclusiones y recomendaciones en términos de las variables en estudios.  Compare con lo obtenido en f)
```{r}
# Se calcula el valor estandard
absl <- t(c1)%*%yp
absl
```
```{r}
sdl <- sqrt(( 13.8/2)*sum(c1^2))
sdl
vcs <- sdl*sqrt(3*qf(0.95,2,6))
vcs
```


